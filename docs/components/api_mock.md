# Управление мок-ответами в API OpenRpc

Мок-ответы особенно полезны для:
- Разработки клиентских приложений до готовности серверной части
- Тестирования различных сценариев работы API
- Демонстрации функциональности API без обращения к реальным данным
- Проверки обработки ошибок и пограничных случаев

Система мок-ответов позволяет создавать, управлять и документировать тестовые заглушки для методов API. 
Моки автоматически встраиваются в основную OpenRPC документацию и помечаются специальным тегом mock.

## Команды

| Команда              | Описание                          |
|----------------------|-----------------------------------|
| `system:mock:add`    | Добавить мок-ответ для метода     |
| `system:mock:remove` | Удалить мок-ответ для метода      |
| `system:mock:list`   | Показать список всех мок-ответов  |
| `system:mock:import` | Импортировать мок-ответы из файла |
| `system:mock:export` | Экспортировать мок-ответы в файл  |

## Синтаксис команд

Наименование метода мока должно [соответствовать структуре домена](../conventions/naming.md).

Пример: _finance.kpi.updateDeputy_

### Добавление мок-ответа

```bash
system:mock:add method_name '{"result":"success"}' '{"param1":"value1"}'
```

Параметры:
- `method_name` - Имя метода, для которого добавляется мок
- `'{"result":"success"}'` - JSON-объект с результатом мок-ответа
- `'{"param1":"value1"}'` - _[опционально] JSON-объект с параметрами запроса, на которые будет срабатывать мок_

### Удаление мок-ответа

```bash
system:mock:remove method_name '{"param1":"value1"}'
```

Можно удалить как метод полностью, так и пример метода с конкретными параметрами 

Параметры:
- `method_name` - Имя метода
- `'{"param1":"value1"}'` - _[опционально] JSON-объект с параметрами запроса, для которых нужно удалить мок_

### Просмотр всех мок-ответов

```bash
system:mock:list
```

### Импорт мок-ответов из файла

Можно полностью импортировать спецификацию мок-ответов из файла JSON. Пример спецификации:

```json
{
    "openrpc": "1.3.0",
    "methods": [
        {
            "name": "test4.test4.test4",
            "summary": "Мок имплементация для test4.test4.test4",
            "examples": [
                {
                    "name": "test4.test4.test4",
                    "description": "Пример для test4.test4.test4 с параметрами: param3=value3",
                    "params": [
                        {
                            "name": "param3",
                            "value": "value3"
                        }
                    ],
                    "result": {
                        "name": "test4.test4.test4 Результат",
                        "value": {
                            "result": "success"
                        }
                    }
                }
            ]
        }
    ]
}
```

```bash
system:mock:import /path/to/file.json
```

Параметры:
- `/path/to/file.json` - Путь к JSON-файлу с мок-ответами

### Экспорт мок-ответов в файл

```bash
system:mock:export /path/to/file.json
```

Параметры:
- `/path/to/file.json` - Путь для сохранения мок-ответов в JSON-формате

## Интеграция с OpenRPC документацией

Моки автоматически интегрируются в основную OpenRPC документацию следующим образом:

1. **На уровне методов**: Методы, имеющие мок-реализацию, получают соответствующий тег `mock`:
   ```
    "tags": [
            {
                "name": "mock",
                "description": "This is a mock method"
            }
        ],
   ```

2. **На уровне примеров**: Каждый мок добавляется как пример с префиксом `[MOCK]` в поле `name`:
   ```
   "name": "[MOCK] method_name"
   ```
