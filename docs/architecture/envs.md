### Переменные окружения

Проект зависит от переменных окружения, куда вынесены значения,
специфичные для среды развёртки (подробнее с подходом можно [ознакомиться тут](https://12factor.net/ru/config))

Полная документация по [конфигурации Symfony](https://symfony.com/doc/current/configuration.html#configuration-files)

`.env / .env.dev / .env.prod` - файлы под git, содержат настройки по умолчанию.
Конфиденциальные данные в них не содержатся, а прокидываются из системы
(обычно это CI/CD variables).

В `.env.local` переключается текущее окружение (`dev / prod`) + тут удобно локально
прописать конфиденциальные данные.
В файлах `.env.dev.local` и `.env.prod.local` локально переопределяются переменные для конкретных окружений.

> **Важно:** при деплое выполняется команда `composer dump-env ENV_NAME`, она создает файл
> `.env.local.php`, который в итоге используется на сервере

Команда `bin/console debug:dotenv` позволяет посмотреть, какие env файлы сейчас используются
и какое значение имеет каждая переменная среды.

### Поведение, завязанное на стандартные env

| Переменная | Значение | Поведение                                                         |
|------------|----------|-------------------------------------------------------------------|
| APP_ENV    | dev      | PHP аттрибуты считываются из файлов контроллеров через Reflection |
| APP_ENV    | !dev     | PHP аттрибуты получаем из кэша                                    |
| APP_ENV    | dev      | (API) в `error.data` добавляются доп.данные об ошибке             |
| APP_ENV    | !dev     | (API) в `error.data` не содержит отладочной информации            |
| APP_ENV    | prod     | Создается opcache.preload для оптимизации загрузки скриптов       |

### Дополнительные env

У нас есть несколько дополнительных переменных, упрощающих локальную разработку:

| Переменная      | Тип     | Поведение                                                                |
|-----------------|---------|--------------------------------------------------------------------------|
| DB_IS_PROD      | boolean | Все SQL запросы выполняются на тестовой копии БД                         |
| DB_LOG_TYPE     | string  | Способ записи лога SQL запросов (см. Database\Connection\Logger\LogType) |
| SKIP_AUTH       | boolean | Пропускаем авторизацию (см. CheckAccessController / AuthUserChecker)     |
| INTERCEPT_EMAIL | string  | Все письма отправляются на указанный email (НЕ РЕАЛИЗОВАНО)              |

Эти env игнорируются в prod окружении.
