# Внедрение клиента на front для OpenRPC API

## Дата создания
08.10.2025

## Статус
Принятый

---

## Контекст

В текущей архитектуре фронтенд-приложение (Vue.js) взаимодействует с backend через JSON-RPC API,
используя ручные вызовы через fetch/axios. Это создает следующие проблемы:

1. **Отсутствие типизации** — нет контроля типов для запросов и ответов, что приводит к runtime ошибкам
2. **Дублирование типового кода** — каждый RPC-метод требует написания однотипного boilerplate кода для формирования запроса
3. **Расхождение с API** — изменения в backend API не отслеживаются автоматически, что приводит к несинхронизированности контрактов
4. **Сложность поддержки** — при изменении API необходимо вручную обновлять все точки вызова
5. **Отсутствие IDE-подсказок** — нет автодополнения и валидации на этапе разработки

### Требования:
- Наличие OpenRPC спецификации API на backend
- Необходимость строгой типизации запросов/ответов
- Автогенерация клиента из спецификации
- Перспектива поддержки WebSocket/альтернативных транспортов в будущем
- Совместимость с Vue.js и возможность миграции на TypeScript

---

## Решение

**Внедрение обёртки над библиотекой `@open-rpc/client-js` с автогенерацией типизированного клиента из OpenRPC спецификации.**

### Обоснование:

- Клиент генерируется автоматически из существующей OpenRPC спецификации
- Гарантирует соответствие контракта между frontend и backend
- Устраняет ручное написание типового кода
- Автоматическая генерация TypeScript типов из схемы
- Валидация на этапе разработки (при миграции на TS)
- Автодополнение в IDE для всех методов и параметров
- OpenRPC — это индустриальный стандарт для JSON-RPC API
- Официальная библиотека от создателей спецификации
- Поддержка HTTP/HTTPS (текущая потребность)
- Готовность к WebSocket/другим транспортам без изменения API клиента
- Единая точка входа для всех RPC-вызовов
- Централизованная обработка ошибок
- Возможность добавления middleware (логирование, retry, и т.д.)

---

## Альтернативные варианты

- REST API клиент (axios + OpenAPI/Swagger) - Не соответствует текущей архитектуре системы
- GraphQL - Требует внедрения GraphQL слоя на backend, избыточная сложность для текущих требований
- tRPC - Требует TypeScript на backend и frontend
- Самописный генератор клиента - сложность поддержки
- Ручные fetch/axios вызовы с TypeScript (текущий подход + TS) - остаются проблемы синхронизации, не гарантий соответствия

---

## Последствия

> *Раздел будет заполнен через 2-3 месяца после внедрения*

### Ожидаемые положительные эффекты:
- Снижение количества runtime ошибок, связанных с API
- Ускорение разработки новых фич
- Улучшение опыта разработки (автодополнение, валидация)
- Упрощение онбординга новых разработчиков
- Автоматическое обновление клиента при изменении API

### Потенциальные риски:
- Время на первоначальное изучение
- Зависимость от внешней библиотеки

### Метрики для оценки:
- Количество API-related багов (до/после)
- Время разработки новых API интеграций
- Время на адаптацию изменений в API

---

**Связанные документы:**
- [OpenRPC спецификация](https://spec.open-rpc.org/)
