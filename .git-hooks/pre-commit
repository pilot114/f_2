#!/bin/sh

RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
NC='\033[0m'

echo "${YELLOW}üîÑ –ó–∞–ø—É—Å–∫ –±—ã—Å—Ç—Ä—ã—Ö –∞–≤—Ç–æ—Ñ–∏–∫—Å–æ–≤...${NC}"

# –¢–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ñ–∏–∫—Å—ã –∏ –ø—Ä–æ—Å—Ç–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
composer rector-fix
composer ecs-fix
composer syntax-lint

if [ $? -ne 0 ]; then
    echo "${RED}‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞${NC}"
    exit 1
fi

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
if ! git diff --quiet; then
    echo "${GREEN}‚úÖ –ê–≤—Ç–æ—Ñ–∏–∫—Å—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–º–º–∏—Ç${NC}"
    git add -u
fi

exit 0